name: My first deploy

on:
  push:
    branches:
      - main

jobs:
  Step1:
    runs-on: ubuntu-latest

    steps:
    - name: Download repo
      uses: actions/checkout@v3
    
    - name: Check code meets quality standards
      id: codiga
      uses: codiga/github-action@master
      with:
        repo_token: "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"
        codiga_api_token: ${{ secrets.CODE_INSPECTOR_CODIGA }}
        force_ref: 'none'
        min_quality_grade: 'WARNING'
        min_quality_score: '50'
        max_defects_rate: '0.0001'
        max_complex_functions_rate: '0.0001'
        max_long_functions_rate: '0.0001'
        project_name: ''
        max_timeout_sec: '600'

    - name: npm
      run: |
        sudo apt install nodejs npm
        nodejs --version
  
  Step2:
    runs-on: ubuntu-latest
    needs: Step1

    steps:
      - name: whoami?
        run: whoami

      - name: Configure my AWS Credentials
        uses: aws-actions/configure-aws-credentials@v1
        with:
          aws-access-key-id    :  "AKIAX7KWAWWCFKKBGSGT"
          aws-secret-access-key:  "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"
          aws-region           :  "eu-central-1"

      - name: aws cli test
        run: aws s3 ls